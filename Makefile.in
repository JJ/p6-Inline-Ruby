.PHONY: clean test

all: %DESTDIR%/resources/libraries/%rbhelper%

clean:
	rm %DESTDIR%/resources/libraries/%rbhelper%

%DESTDIR%/resources/libraries/%rbhelper%: rbhelper.c
	# This will use pkg-config to try finding ruby
	# looks for 2.3, 2.2, 2.1, 2.0
	gcc -Wall -shared -fPIC -g \
		rbhelper.c \
		%rb-gcc-args% \
		-o %DESTDIR%/resources/libraries/%rbhelper%

test: all
	prove -e 'perl6 -Ilib' t
